@page "/projects/{id:int}"

@using static teko_projektarbeit_loesungsalgorithmen.Objects.User
@using teko_projektarbeit_loesungsalgorithmen.Components.Partials
@using teko_projektarbeit_loesungsalgorithmen.Services

@inject SessionService SessionService
@inject DataService DataService
@inject NavigationManager NavigationManager

@rendermode InteractiveServer

<div class="card-header d-flex justify-content-between align-items-end">
    <h3>@(id == 0 ? "Neues Projekt" : (CurrentUser.Role != ProjectRole.Lead ? "Projekt ansehen" : "Projekt bearbeiten"))</h3>

    <a href="@(NavigationManager.Uri)/history" class="mb-2">Ältere Versionen</a>
</div>
<Project ProjectId="id">
</Project>

@code {

    [Parameter]
    public int id { get; set; }

    Objects.User CurrentUser = new Objects.User(0, "", ProjectRole.Staff);

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            CurrentUser = DataService.GetUserById((int)await SessionService.GetUserId()) ?? new Objects.User(0, "", ProjectRole.Staff);
        }
        StateHasChanged();
    }

}
